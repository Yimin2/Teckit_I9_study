# IPC(Inter Process Communication)

## 1. 정의

: 프로세스 간 통신

프로세스는 각각의 주소공간을 할당받아 상호 독립적으로 실행된다. ([참고 - 프로세스 주소공간](https://github.com/harriet221/Teckit_I9_study/blob/main/week02_11.02-11.08/week02_%EC%9C%A4%EC%84%9C%EC%A0%95-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4_%EC%A3%BC%EC%86%8C%EA%B3%B5%EA%B0%84.md))
그러나 서로 독립적으로 실행되는 프로세스 간에도 통신이 필요한 경우가 있을 수 있음. 프로세스 간 통신 = IPC 통신

프로세스는 커널이 제공하는 다양한 IPC 설비를 이용해 다른 프로세스와 통신을 주고받을 수 있음.

## 2. 종류

### 1. Pipe

: 기본적으로는 부모 프로세스와 자식 프로세스 사이에서 단방향 통신을 제공하는 메커니즘. 부모 프로세스가 파이프를 생성하고, 자식 프로세스에게 상속하여 통신함. (= 익명 파이프)

- ### 익명 Pipe

  부모 자식처럼 통신할 프로세스를 명확히 알 수 있는 경우에 사용. 해당 두 개의 프로세스를 연결하는데, 하나의 프로세스는 데이터 쓰기만, 다른 하나는 데이터 읽기만 가능.

  **= 한쪽 방향으로만 통신이 가능한 반이중 통신**

  따라서 양방향 송수신을 하고 싶으면 2개의 파이프 필요.

  장점: 간단한 사용. 단순한 데이터 흐름을 가질 때 효율적.<br>
  단점: 전이중 통신을 위해 파이프 2개를 만들어야 할 때 구현 복잡함.

- ### Named PIPE(FIFO)

  (익명) 파이프 방식의 응용. 파일 시스템에 이름이 부여된(Named) 파이프로, 파일 시스템에서 특정 경로에 파일처럼 파이프가 생성되고 이름이 부여되어, 다른 프로세스는 이름을 통해 해당 파이프에 접근할 수 있음. 서로 모르는 상태의 프로세스들 사이 통신 가능.

  장점: 익명 파이프의 확장, **부모 프로세스와 무관한 다른 프로세스와도 통신 가능**.<br>
  단점: Named 파이프 역시 읽기/쓰기 동시에 불가능. 전이중 통신을 위해서는 익명 파이프처럼 2개를 만들어야 함. (구현 복잡)

### 2. Message Queue

: 프로세스 간에 메시지를 주고받을 수 있는 큐. 큐의 형태를 띠므로 데이터의 순서가 보장되며, 각각의 메시지에는 타입 지정 가능. 이름이 부여되어 있지 않으나, 특정 키 값으로 식별. 다른 프로세스가 해당 키 값을 알고 있다면 접근 가능함.

읽고 쓰는 방식이라는 점, 서로 모르는 상태의 프로세스들 사이 통신이 가능한 점이 Named Pipe와 유사하지만, 메시지 큐는 파이프처럼 데이터의 흐름이 아니라 **메모리 공간**이기 떄문에, 사용할 데이터에 번호를 붙이면서 **여러 프로세스가 동시에 데이터를 쉽게 다룰 수 있음**.

### 3. 공유 메모리

: 두 개 이상의 프로세스가 동일한 물리적 메모리 공간을 공유하게 해주는 메커니즘. 파이프, 메시지 큐가 통신을 이용한 설비라면, **공유 메모리는 데이터 자체를 공유하도록** 지원하는 설비.

프로세스의 메모리 영역은 각자 독립적이며 다른 프로세스가 접근하지 못하도록 반드시 보호되어야 함. 하지만 한편으로 파이프 통신을 통한 데이터 전달 보다 스레드처럼 메모리를 공유하도록 해준다면 더욱 용이할 것은 분명. 그래서 공유 메모리는 **프로세스간 메모리 영역을 공유해서 사용할 수 있도록 허용**하는 매커니즘.

프로세스가 공유 메모리 할당을 커널에 요청하면, 커널은 해당 프로세스에 메모리 공간을 할당, 이후 모든 프로세스는 해당 메모리 영역에 접근할 수 있게 하는 매커니즘. 이를 통해 한 프로세스에서 변경한 데이터를 다른 프로세스에서 읽을 수 있으며, **중개자 없이 곧바로 메모리에 접근할 수 있어서 IPC 중에 가장 빠르게 작동함**.

#### 메모리를 공유하는 프로세스의 메모리 보호

: 해당 프로세스는 공유하지 않는 작업 영역을 명확히 지정하여 그 부분의 접근은 금지하고, 공유 부분에 대해서는 읽기 전용으로 설정하거나, 공유 메모리에 접근하기 위한 식별자나 키를 별도 지정하고 [세마포어(Semaphore)와 뮤텍스(Mutex)](https://github.com/harriet221/Teckit_I9_study/blob/main/week02_11.02-11.08/week02_%EA%B8%88%EC%A2%85%EC%9D%80_Mutex_Semaphore.md) 등의 동기화 기법을 사용하는 등 다양한 방식으로 메모리를 보호함.

### 4. 메모리 맵

주로 파일로 대용량 데이터를 공유해야 할 때나, I/O와 데이터 공유를 위해 사용하는 방법. IPC에서도 응용해서 사용. 공유 메모리처럼 메모리를 공유해준다. 메모리 맵은 **열린 파일을 메모리에 맵핑시켜서 공유**하는 방식이다. (즉 공유 매개체가 파일+메모리)

### 5. 소켓

네트워크를 통해 프로세스 간에 데이터를 공유하는 방법. 주로 TCP/IP 기반의 네트워크 상에서 프로세스 간 통신을 지원. 클라이언트와 서버가 소켓을 통해서 통신하는 구조로, 원격에서 프로세스 간 데이터를 공유해야 할 때 사용.

- 서버(bind, listen, accept): 소켓 생성 + 클라이언트 연결 요청 수락
- 클라이언트(connect): 서버에 연결 요청

<br>

## 3. 지난 주제들과의 연관성

이러한 IPC 통신에서 프로세스 간 데이터를 동기화하고 보호하기 위해 [세마포어와 뮤텍스](https://github.com/harriet221/Teckit_I9_study/blob/main/week02_11.02-11.08/week02_%EA%B8%88%EC%A2%85%EC%9D%80_Mutex_Semaphore.md)를 사용함. (프로세스 간에 공유 자원의 접근을 제어하기 위한 동기화 기법. 공유된 자원에 한번에 하나의 프로세스만 접근시킬 때 사용. IPC 매커니즘의 하나로 보아도 무방)

[시스템 콜](https://github.com/harriet221/Teckit_I9_study/blob/main/week03_11.09-11.15/week03_%EC%9C%A4%EC%84%9C%EC%A0%95-%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%BD%9C.md)은 IPC 메커니즘을 사용하여 프로세스 간 통신을 구현함. 파이프나 메시지 큐를 생성하고 조작하기 위해서는 특정 시스템 콜을 사용하는 등. 이러한 시스템 콜을 통해 프로세스는 IPC 기능을 활용하여 다른 프로세스와 데이터를 주고받고, 동기화를 유지할 수 있음. (이때 시스템 콜은 운영 체제의 커널에서 해당 기능을 수행하도록 요청하는 역할)
