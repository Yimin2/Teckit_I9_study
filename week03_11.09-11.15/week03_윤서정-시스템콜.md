## Prologue. 이전에 등장했던 부분

어플리케이션은 System Calls을 통해 OS와 통신한다. ☞ OS 커널 설명 부분

사용자의 프로그램 실행 명령(System Calls)으로 인한 커널 모드 전환 등... ☞ 소프트웨어 인터럽트 설명 부분

# 시스템 콜(System Call)

## 1. 정의

: 사용자 프로그램이나 응용 프로그램이 운영 체제의 핵심 부분에 위치한 커널에게 특정 기능 또는 서비스를 요청하기 위해 사용하는 인터페이스.
프로그램이 운영 체제의 특정 기능을 사용하려면, 해당 기능에 대한 시스템 콜을 호출해야 함.
시스템 콜은 주로 하드웨어와 상호 작용하거나 운영 체제에서 제공하는 서비스에 접근하기 위해 사용.
즉, 사용자가 파일 여닫기, 프로세스 생성 및 종료, 메모리를 할당 및 해제, 입출력 작업 수행 등의 작업을 요청하는데, 이때 각각의 작업은 해당하는 시스템 콜을 호출하여 커널에게 요청됨.
시스템 콜은 사용자 프로그램이 커널 모드로 전환되어 특권 명령을 실행하도록 허용하며, 이를 통해 운영 체제의 핵심 기능에 접근할 수 있다.

## 2. 종류

- 일반적인 파일 관련 시스템 콜:

  - open(): 파일 열기
  - read(), write(): 파일에서 읽거나 쓰기 요청

- 프로세스 관리 시스템 콜:

  - fork(): 새로운 프로세스 생성
  - exec(): 새로운 프로그램 실행

- 메모리 관리 시스템 콜:

  - brk(), sbrk(): 프로세스의 힙 영역 크기 조절
  - mmap(): 파일이나 장치를 메모리에 매핑

- 프로세스 통신 시스템 콜:

  - pipe(): 프로세스 간의 통신 파이프 생성
  - socket(): 네트워크 통신을 위한 소켓 생성

- 시스템 정보 및 제어 시스템 콜:

  - time(), date(): 현재 시간이나 날짜 정보 가져오기
  - kill(): 프로세스 종료

## 3. 예시

프로세스 관리 시스템 콜의 실행 예시를 살펴보자.
wait는 Parent Process가 Child Process가 끝날 때까지 기다리는 명령어다.

다음은 부모 프로세스가 자식 프로세스를 생성하고, 자식 프로세스가 실행되면 부모 프로세스가 자식 프로세스의 종료를 기다리는 간단한 예제이다.

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/wait.h>

int main(int argc, char *argv[]) {
    printf("pid : %d", (int) getpid()); // pid : 29146

    int rc = fork();
    // fork(): 현재 실행 중인 프로세스(parent)를 복제하여 새로운 프로세스(child)를 생성. (실패시 -1 반환)
    // 이때 rc는 부모 프로세스에서는 자식 프로세스의 PID를, 자식 프로세스에서는 0을 가지게 됨.

    // 부모 및 자식 프로세스 분기
    if (rc < 0) {                   // (1) fork 실패 -> 종료
        exit(1);
    }
    else if (rc == 0) {				// (2) child 프로세스에서 실행
        printf("child (pid : %d)", (int) getpid());
    }
    else {							// (3) parent 프로세스에서 실행
        int wc = wait(NULL)
        // wait(): 부모 프로세스가 자식 프로세스의 종료를 기다림 + 자식 프로세스가 종료되면 종료 상태 정보를 반환
        printf("parent of %d (wc : %d / pid : %d)", wc, rc, (int)getpid());
    }
}
```

> **출력 결과**<br>
> pid : 29146<br>
> child (pid : 29147)<br>
> parent of 29147 (wc : 29147 / pid : 29146)

프로세스 생성과 프로세스 간 통신을 다루는 이러한 시스템 콜은
부모 프로세스가 여러 개의 자식 프로세스를 생성하여 병렬로 작업을 처리하는 병렬 컴퓨팅 구현
서버-클라이언트 모델에서 서버가 fork를 사용하여 새로운 프로세스를 생성하여 클라이언트와의 통신을 처리
부모 프로세스는 작업을 여러 자식 프로세스에게 분배하고, 각 자식 프로세스는 독립적으로 작업을 수행
프로세스 간 파이프, 소켓, 공유 메모리 등을 사용한 데이터 교환, 통신 및 동기화
데몬 프로세스는 백그라운드에서 실행되는 프로세스로, fork를 사용하여 백그라운드에서 동작하면서 메인 프로세스와는 독립적으로 일을 처리

다만, 프로세스 간의 통신은 자원 소모가 크므로, 적절한 상황에서 적절하게 사용해야 함.
또한, 최근에는 스레드를 사용한 병렬 처리도 많이 사용되는 추세.
